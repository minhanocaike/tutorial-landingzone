# Terraform Azure Landing Zone

# IntroduÃ§Ã£o ğŸ“ƒ

Este repositÃ³rio tem como objetivo servir de exemplo para um modelo de implementaÃ§Ã£o de landing zone
com Terraform. Os diretorios listados sÃ£o um modelo de abordagem para estruturaÃ§Ã£o do seu projeto.


# DiretÃ³rios ğŸ“

```jsx
â”œâ”€â”€ azure-pipelines
â”‚Â Â  â”œâ”€â”€ azure-pipelines.yml
â”‚Â Â  â”œâ”€â”€ terraform-apply.yml
â”‚Â Â  â”œâ”€â”€ terraform-plan.yml
â”‚Â Â  â””â”€â”€ terraform-validate.yml
â”‚Â Â  â””â”€â”€ terraform-validate.yml
â”œâ”€â”€ core
â”‚Â Â  â”œâ”€â”€ nonproduction
â”‚Â Â  â””â”€â”€ production
â”œâ”€â”€ modules
â”‚Â Â  â”œâ”€â”€ computing
â”‚Â Â  â”œâ”€â”€ container
â”‚Â Â  â”œâ”€â”€ database
â”‚Â Â  â”œâ”€â”€ key-vault
â”‚Â Â  â”œâ”€â”€ monitoring
â”‚Â Â  â”œâ”€â”€ networking
â”‚Â Â  â”œâ”€â”€ security
â”‚Â Â  â”œâ”€â”€ storage-account
â”‚Â Â  â””â”€â”€ ...
â”œâ”€â”€ README.md
â””â”€â”€ settings
    â””â”€â”€ scripts

```

```jsx
â”œâ”€â”€ azure-pipelines
```
Os scripts utilizados para execuÃ§Ã£o das esteiras no Azure DevOps, podem estar contidos neste diretÃ³rio.

```
â”œâ”€â”€ modules

```
Este diretÃ³rio contÃªm os arquivos e diretÃ³rios que serÃ£o implementados em cloud seguindo as melhores prÃ¡ticas,
utilizando os mÃ³dulos terraform para reutilizaÃ§Ã£o de recursos com as regras de implementaÃ§Ã£o bem definidas.

```
â”€â”€ core
Â Â  â”œâ”€â”€ nonproduction
Â Â  â”‚Â Â  â”œâ”€â”€ infrahub
Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ connectivity
Â Â  â”‚Â Â  â”‚Â Â  â”‚Â    â”œâ”€â”€ backend.tf
Â Â  â”‚Â Â  â”‚Â Â  â”‚Â    â”œâ”€â”€ data.tf
Â Â  â”‚Â Â  â”‚Â Â  â”‚Â    â”œâ”€â”€ main.tf
Â Â  â”‚Â Â  â”‚Â Â  â”‚Â    â””â”€â”€ variables.tf
Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ corp
Â Â  â”‚Â Â  â”‚Â Â  Â     â”œâ”€â”€ backend.tf
Â Â  â”‚Â Â  â”‚Â Â  Â     â”œâ”€â”€ data.tf
Â Â  â”‚Â Â  â”‚Â Â  Â     â”œâ”€â”€ main.tf
Â Â  â”‚Â Â  â”‚Â Â  Â     â””â”€â”€ variables.tf
Â Â  â”‚Â Â  Â Â   â””â”€â”€ ...
Â Â  â”‚Â Â  â””â”€â”€ corp
Â Â  â”‚Â Â  Â Â   â””â”€â”€ project-name
Â Â  â”‚Â Â  Â Â       â”œâ”€â”€ backend.tf
Â Â  â”‚Â Â  Â Â       â”œâ”€â”€ data.tf
Â Â  â”‚Â Â  Â Â       â”œâ”€â”€ main.tf
Â Â  â”‚Â Â  Â Â       â””â”€â”€ variables.tf
Â Â  â”‚Â Â  Â Â   â””â”€â”€ ...
   â””â”€â”€
Â Â  Â Â  Â Â  

```
Este diretÃ³rio contÃªm os arquivos raiz para a criaÃ§Ã£o da infraestrutura por ambiente e projeto

EstÃ¡ organizado da seguinte forma:

- **nonproduction** â†’ ContÃ©m as landing zones nÃ£o produtivas agrupando por projeto os arquivos principais para provisionamento do terraform.
- **production** â†’ ContÃ©m as landing zones de produÃ§Ã£o agrupando por projeto os arquivos principais para provisionamento do terraform.
- **infrahub** â†’ Nesse diretÃ³rio estÃ£o os arquivos que sÃ£o necessÃ¡rios para criaÃ§Ã£o dos recursos base de infraestrutura para cada landing zone, que serÃ£o integrados com conectividade.
- **connectivity** â†’ Nesse diretÃ³rio estÃ£o os arquivos para provisionamento dos recursos na subscriptoin hub (**Disia - Connectivity**). Obs: Aparece somente no diretÃ³rio ***production*** pois nÃ£o possui um ambiente de testes para landing zone hub.


```jsx
â””â”€â”€ settings
    â””â”€â”€ scripts
```
O diretÃ³rio *settings* agrupa arquivos e scripts para utilizaÃ§Ã£o no backend (template para publicaÃ§Ã£o no azure), etc.

# Deploy ğŸ“¥

Para executar os scripts Ã© necessÃ¡rio a esteira de infraestrutura para o projeto com os scripts de implantaÃ§Ã£o.

---

Para visualizar o que serÃ¡ criado/alterado executar: `Terrafom plan`

Para implantaÃ§Ã£o efetiva no ambiente executar: `Terraform apply`

# Principais Arquivos â€¼ï¸

```
main.tf
```

Este arquivo irÃ¡ conter o provisionamento dos principais recursos para o projeto (chamada de mÃ³dulos terraform e recursos locais)

```
variables.tf
```

Neste arquivo serÃ£o incluÃ­das todas as variÃ¡veis utilizadas no mÃ³dulo em questÃ£o 

|â€” Para variÃ¡veis utilizadas para nomear recursos ou definir nomes dentro do projeto, utilizar camelCase 

|â€” Para variÃ¡veis que definam o tamanho em termos nÃºmericos (tamanho de disco, tamanho de RAM) separar por "_", exemplo: ram_size_gb

```
outputs.tf
```

ContÃªm as saÃ­das do mÃ³dulo que serÃ£o gerados no main.tf

```
backend.tf
```

Arquivo para configuraÃ§Ã£o de providers utilizados no projeto, as variÃ¡veis e credenciais com permissÃ£o de execuÃ§Ã£o estÃ£o configuradas no grupo de vÃ¡riaveiss referente a landing zone no Azure DevOps.
